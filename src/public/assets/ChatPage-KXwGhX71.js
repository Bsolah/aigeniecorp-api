import{F as I,G as L,I as R,J as E,K as B,P as q,Q as $,r as u,m as F,j as e,p as U,k as y,i as N,U as T,h as Y,x as G,V as z,l as k,c as K,B as J,H,D as X,n as Z,W as ee}from"./index-BWq_bGw4.js";import{I as b}from"./iconify-w8KctWgo.js";import{C as te,B as se}from"./BreadcrumbComp-ZwjIHcWJ.js";let ae={};function ne(){return ae}function V(t){const a=I(t),s=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return s.setUTCFullYear(a.getFullYear()),+t-+s}function re(t,...a){const s=L.bind(null,t||a.find(n=>typeof n=="object"));return a.map(s)}function ie(t,a){const s=+I(t)-+I(a);return s<0?-1:s>0?1:s}function oe(t){return L(t,Date.now())}function le(t){return a=>{const n=(t?Math[t]:Math.trunc)(a);return n===0?0:n}}const ce={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},de=(t,a,s)=>{let n;const i=ce[t];return typeof i=="string"?n=i:a===1?n=i.one:n=i.other.replace("{{count}}",a.toString()),s!=null&&s.addSuffix?s.comparison&&s.comparison>0?"in "+n:n+" ago":n};function A(t){return(a={})=>{const s=a.width?String(a.width):t.defaultWidth;return t.formats[s]||t.formats[t.defaultWidth]}}const me={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},he={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ue={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xe={date:A({formats:me,defaultWidth:"full"}),time:A({formats:he,defaultWidth:"full"}),dateTime:A({formats:ue,defaultWidth:"full"})},fe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ge=(t,a,s,n)=>fe[t];function S(t){return(a,s)=>{const n=s!=null&&s.context?String(s.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,m=s!=null&&s.width?String(s.width):o;i=t.formattingValues[m]||t.formattingValues[o]}else{const o=t.defaultWidth,m=s!=null&&s.width?String(s.width):t.defaultWidth;i=t.values[m]||t.values[o]}const c=t.argumentCallback?t.argumentCallback(a):a;return i[c]}}const pe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ve={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},je={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},be={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ye={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},we={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Ne=(t,a)=>{const s=Number(t),n=s%100;if(n>20||n<10)switch(n%10){case 1:return s+"st";case 2:return s+"nd";case 3:return s+"rd"}return s+"th"},Me={ordinalNumber:Ne,era:S({values:pe,defaultWidth:"wide"}),quarter:S({values:ve,defaultWidth:"wide",argumentCallback:t=>t-1}),month:S({values:je,defaultWidth:"wide"}),day:S({values:be,defaultWidth:"wide"}),dayPeriod:S({values:ye,defaultWidth:"wide",formattingValues:we,defaultFormattingWidth:"wide"})};function C(t){return(a,s={})=>{const n=s.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],c=a.match(i);if(!c)return null;const o=c[0],m=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],p=Array.isArray(m)?Ce(m,f=>f.test(o)):Se(m,f=>f.test(o));let x;x=t.valueCallback?t.valueCallback(p):p,x=s.valueCallback?s.valueCallback(x):x;const v=a.slice(o.length);return{value:x,rest:v}}}function Se(t,a){for(const s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&a(t[s]))return s}function Ce(t,a){for(let s=0;s<t.length;s++)if(a(t[s]))return s}function ke(t){return(a,s={})=>{const n=a.match(t.matchPattern);if(!n)return null;const i=n[0],c=a.match(t.parsePattern);if(!c)return null;let o=t.valueCallback?t.valueCallback(c[0]):c[0];o=s.valueCallback?s.valueCallback(o):o;const m=a.slice(i.length);return{value:o,rest:m}}}const Pe=/^(\d+)(th|st|nd|rd)?/i,De=/\d+/i,We={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Fe={any:[/^b/i,/^(a|c)/i]},Ae={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ie={any:[/1/i,/2/i,/3/i,/4/i]},Te={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ze={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Oe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Re={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ee={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Be={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},qe={ordinalNumber:ke({matchPattern:Pe,parsePattern:De,valueCallback:t=>parseInt(t,10)}),era:C({matchPatterns:We,defaultMatchWidth:"wide",parsePatterns:Fe,defaultParseWidth:"any"}),quarter:C({matchPatterns:Ae,defaultMatchWidth:"wide",parsePatterns:Ie,defaultParseWidth:"any",valueCallback:t=>t+1}),month:C({matchPatterns:Te,defaultMatchWidth:"wide",parsePatterns:ze,defaultParseWidth:"any"}),day:C({matchPatterns:Oe,defaultMatchWidth:"wide",parsePatterns:Re,defaultParseWidth:"any"}),dayPeriod:C({matchPatterns:Ee,defaultMatchWidth:"any",parsePatterns:Be,defaultParseWidth:"any"})},Ve={code:"en-US",formatDistance:de,formatLong:xe,formatRelative:ge,localize:Me,match:qe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function _e(t,a,s){const n=ne(),i=(s==null?void 0:s.locale)??n.locale??Ve,c=ie(t,a);if(isNaN(c))throw new RangeError("Invalid time value");const o=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:c}),[m,p]=re(s==null?void 0:s.in,...c>0?[a,t]:[t,a]),x=le((s==null?void 0:s.roundingMethod)??"round"),v=p.getTime()-m.getTime(),f=v/q,d=V(p)-V(m),l=(v-d)/q,w=s==null?void 0:s.unit;let g;if(w?g=w:f<1?g="second":f<60?g="minute":f<R?g="hour":l<E?g="day":l<B?g="month":g="year",g==="second"){const r=x(v/1e3);return i.formatDistance("xSeconds",r,o)}else if(g==="minute"){const r=x(f);return i.formatDistance("xMinutes",r,o)}else if(g==="hour"){const r=x(f/60);return i.formatDistance("xHours",r,o)}else if(g==="day"){const r=x(l/R);return i.formatDistance("xDays",r,o)}else if(g==="month"){const r=x(l/E);return r===12&&w!=="month"?i.formatDistance("xYears",1,o):i.formatDistance("xMonths",r,o)}else{const r=x(l/B);return i.formatDistance("xYears",r,o)}}function O(t,a){return _e(t,oe(t),a)}const Q=$.create();Q.interceptors.response.use(t=>t,t=>Promise.reject(t.response&&t.response.data||"Wrong Services"));const P=u.createContext({chatData:[],chatContent:[],chatSearch:"",selectedChat:null,loading:!0,activeChatId:null,setChatContent:()=>{},setChatSearch:()=>{},setSelectedChat:()=>{},setActiveChatId:()=>{},sendMessage:()=>{},setLoading:()=>{}}),Le=({children:t})=>{const[a,s]=u.useState([]),[n,i]=u.useState([]),[c,o]=u.useState(""),[m,p]=u.useState(null),[x,v]=u.useState(1),[f,d]=u.useState(!0),{chatRooms:l}=F(r=>r.chatRoom);console.log("response ",l),u.useEffect(()=>{p(l.chats[0]),v(l.chats[0].id)},[]),u.useEffect(()=>{s(l.chats)},[a,n,c,l]),u.useEffect(()=>{const r=a.find(j=>j.id===(m==null?void 0:m.id));p(r),v(r==null?void 0:r.id)},[a]);const g={chatData:a,chatContent:n,chatSearch:c,selectedChat:m,loading:f,activeChatId:x,setChatContent:i,setChatSearch:o,setSelectedChat:p,setActiveChatId:v,sendMessage:async(r,j)=>{try{const h=await Q.post("/api/sendMessage",{chatId:r,message:j});if(h.status===201){const D=h.data;p(M=>({...M,messages:[...M.messages,D]})),s(M=>M.map(W=>W.id===r?{...W,messages:[...W.messages,D]}:W))}else console.error("Failed to send message:")}catch(h){console.error("Error sending message:",h)}},setLoading:d};return e.jsx(P.Provider,{value:g,children:t})},Ye=()=>{const{user:t}=F(r=>r.auth),a=[{icon:"solar:settings-outline",listtitle:"Setting",divider:!0},{icon:"solar:question-circle-outline",listtitle:"Help and feedback",divider:!1},{icon:"solar:logout-2-outline",listtitle:"Sign Out",divider:!1}],s=r=>{var j;return(j=k.last(r.messages))==null?void 0:j.createdAt},n=r=>{let j="";const h=r.messages[r.messages.length-1];if(h){const D=h.senderId===r.id?"You: ":"",M=h.type==="image"?"Sent a photo":h.msg;j=`${D}${M}`}return j},{chatData:i,chatSearch:c,setChatSearch:o,setSelectedChat:m,setActiveChatId:p,activeChatId:x}=u.useContext(P),v=r=>{o(r.target.value)},f=i==null?void 0:i.filter(r=>r.name.toLowerCase().includes(c.toLowerCase())),d=f.filter(r=>r.name==="Genie Bot"),l=f.filter(r=>r.name!=="Genie Bot"),w=r=>{const j=r.id;m(r),p(j)},g=r=>{const j=r.find(h=>h.name==="Genie Bot");return e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"flex justify-start h-8 p-2 bg-lightprimary text-ld dark:bg-lightprimary",children:j?"Agents":"Employees"}),r.map(h=>e.jsxs("div",{className:`cursor-pointer py-4 px-6 gap-0 flex justify-between group bg-hover ${x===h.id?"bg-lighthover dark:bg-darkmuted":"initial"}`,onClick:()=>w(h),children:[e.jsxs("div",{className:"flex items-center gap-3 max-w-[235px] w-full",children:[e.jsxs("div",{className:"relative min-w-12",children:[e.jsx("img",{src:h.thumb??z,height:48,width:48,alt:"user",className:"rounded-full"}),h.status=="online"?e.jsx(y,{color:"success",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):h.status=="busy"?e.jsx(y,{color:"error",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):h.status=="away"?e.jsx(y,{color:"warning",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):e.jsx(y,{color:"primary",className:"p-0 h-2 w-2 absolute bottom-1 end-0"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm mb-1",children:h.name}),e.jsx("div",{className:"text-sm text-ld opacity-90 line-clamp-1",children:n(h)})]})]}),e.jsxs("div",{className:"text-xs pt-1",children:[O(new Date(s(h)),{addSuffix:!1}),h.name==="Genie Bot"&&e.jsx("div",{className:"pt-1 text-sm text-ld opacity-90 line-clamp-1 flex justify-end",children:e.jsx(b,{icon:"ri:chat-new-fill",height:"20"})})]})]},h.id))," "]})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"left-part  w-full px-0 ",children:[e.jsxs("div",{className:"flex justify-between items-center px-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:U,height:56,width:56,alt:"user",className:"rounded-full"}),e.jsx(y,{color:"success",className:"p-0 h-2 w-2 absolute bottom-1 end-0"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm mb-1",children:t.username}),e.jsx("p",{className:"text-darklink dark:text-bodytext text-xs",children:"Marketing Director"})]})]}),e.jsx(N,{label:"",dismissOnClick:!1,renderTrigger:()=>e.jsx("span",{className:"h-9 w-9 flex justify-center items-center rounded-full hover:bg-lightprimary hover:text-primary cursor-pointer ",children:e.jsx(T,{size:22})}),children:a.map((r,j)=>e.jsxs(u.Fragment,{children:[e.jsxs(N.Item,{className:"flex gap-3",children:[e.jsx(b,{icon:`${r.icon}`,height:18}),e.jsx("span",{children:r.listtitle})]}),r.divider==!0?e.jsx(N.Divider,{}):null]},j))})]}),e.jsxs("div",{className:"px-6",children:[e.jsx("div",{className:"flex gap-3 bg-white dark:bg-transparent  py-5 items-center ",children:e.jsx(Y,{id:"search",placeholder:"Search contacts",onChange:v,value:c,className:"form-control w-full",sizing:"md",required:!0,icon:()=>e.jsx(b,{icon:"solar:magnifer-line-duotone",height:18})})}),e.jsx("div",{className:"sorting mb-3",children:e.jsxs(N,{label:"Recent Chats",children:[e.jsx(N.Item,{children:"Sort by Time"}),e.jsx(N.Item,{children:"Sort by Unread"}),e.jsx(N.Divider,{}),e.jsx(N.Item,{children:"Sort by Pinned"})]})})]}),e.jsxs("div",{className:"max-h-[600px] h-[calc(100vh_-_100px)]",children:[g(d),g(l)]})]})})},_=()=>{const{selectedChat:t}=u.useContext(P),a=k.uniq(k.flatten(t==null?void 0:t.messages.map(n=>n.attachment))).length,s=k.uniq(k.flatten(t==null?void 0:t.messages.map(n=>(n==null?void 0:n.type)==="image"?n.msg:null))).length-1;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-5",children:[e.jsxs("h6",{className:"text-sm",children:[" Media (",s,")"]}),e.jsx("div",{className:"mt-3",children:e.jsx(e.Fragment,{children:e.jsx(K.Fragment,{children:t==null?void 0:t.messages.map((n,i)=>e.jsx("div",{className:"md:col-span-4 sm:col-span-6 col-span-12",children:(n==null?void 0:n.type)==="image"?e.jsx("img",{src:n.msg,alt:"media",className:"rounded-md",height:100,width:100}):null},i))})})}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h6",{className:"text-sm",children:["  Attachments (",a,")"]}),e.jsx("div",{children:t==null?void 0:t.messages.map((n,i)=>{var c;return e.jsx("div",{children:e.jsx("div",{className:"flex flex-col gap-4 mt-4",children:(c=n==null?void 0:n.attachment)==null?void 0:c.map((o,m)=>e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3 group cursor-pointer",children:[e.jsx("div",{className:"bg-muted dark:bg-darkmuted p-3 rounded-md",children:e.jsx("img",{src:o.icon||"",height:24,width:24,alt:"download"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm group-hover:text-primary",children:o.file}),e.jsx("p",{className:"text-xs text-darklink dark:text-bodytext",children:o.fileSize})]}),e.jsx("div",{className:"btn-circle-hover cursor-pointer invisible  group-hover:visible ms-auto  opacity:50",children:e.jsx(b,{icon:"solar:download-outline",height:"20"})})]})},m))})},i)})})]})]})})},Je=({onClickMobile:t})=>{var f;const{selectedChat:a}=u.useContext(P),[s,n]=u.useState(!1),{user:i}=F(d=>d.auth),c=u.useRef(null);u.useEffect(()=>{a&&m()},[a,a==null?void 0:a.messages]);const o=()=>{n(!s)},m=()=>{var d;(d=c.current)==null||d.scrollIntoView({behavior:"smooth"})},[p,x]=u.useState(!1),v=()=>x(!1);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-5",children:e.jsx("div",{children:a?e.jsxs("div",{className:"flex items-center justify-between ",children:[e.jsxs("div",{className:"flex items-center gap-3 ",children:[e.jsx(J,{color:"lightprimary",className:"btn-circle p-0 lg:hidden flex",onClick:t,children:e.jsx(b,{icon:"solar:hamburger-menu-outline",height:18})}),e.jsxs("div",{className:"relative sm:min-w-12 min-w-9",children:[e.jsx("img",{src:z,height:48,width:48,alt:"user",className:"rounded-full sm:h-12 sm:w-12 h-9 w-9"}),a.status=="online"?e.jsx(y,{color:"success",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):a.status=="busy"?e.jsx(y,{color:"error",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):a.status=="away"?e.jsx(y,{color:"warning",className:"p-0 h-2 w-2 absolute bottom-1 end-0"}):e.jsx(y,{color:"primary",className:"p-0 h-2 w-2 absolute bottom-1 end-0"})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-base sm:mb-1",children:a.name}),e.jsx("div",{className:"text-sm text-ld opacity-90 line-clamp-1",children:a.status})]})]}),e.jsxs("div",{className:"flex items-center md:gap-2 gap-1",children:[e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10",children:e.jsx(b,{icon:"solar:phone-rounded-linear",height:25,className:"sm:h-10 h-5 "})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10",children:e.jsx(b,{icon:"solar:videocamera-outline",height:25,className:"sm:h-10 h-5 "})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10 xl:flex hidden",onClick:o,children:e.jsx(T,{size:18,className:"sm:h-10 h-5 "})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer sm:h-10 sm:w-10 xl:hidden flex",onClick:()=>x(!0),children:e.jsx(T,{size:20,className:"sm:h-10 h-5 "})})]})]}):null})}),e.jsx(H,{className:"my-0"}),e.jsxs("div",{className:"flex max-h-[800px] h-[650px] ",children:[e.jsx("div",{className:`transition-all ${s?"xl:w-[calc(100%_-_300px)] w-full":"lg:w-[calc(100%_-_0px)]"} `,children:e.jsx("div",{className:`${s?"lg:border-e":"border-none"} border-ld h-full py-5 px-5`,children:e.jsx("div",{className:"max-h-[700px] h-[600px]",style:{flexDirection:"column-reverse",overflowY:"auto"},children:e.jsxs("div",{children:[e.jsx(e.Fragment,{children:(f=a==null?void 0:a.messages)==null?void 0:f.map(d=>e.jsx("div",{className:"flex gap-3 mb-[30px]",children:i.username!==d.sender?e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10",children:e.jsx("img",{src:z,height:40,width:40,alt:"user",className:"rounded-full"})}),d.type==="text"?e.jsxs("div",{children:[e.jsxs("div",{className:"text-xs text-ld opacity-60 font-medium mb-1 block",children:[a.name,","," ",O(new Date(d.createdAt),{addSuffix:!1})," ","ago"]}),e.jsx("div",{className:"p-2 bg-muted dark:bg-darkmuted text-ld rounded-md",children:d.msg})]}):null,d.type==="image"?e.jsx("img",{src:d.msg,height:150,width:150,alt:"user",className:"rounded-md"}):null]}):e.jsx("div",{className:"flex  justify-end w-full",children:e.jsxs("div",{children:[d.timestamp?e.jsxs("div",{className:"text-xs text-ld opacity-60 font-medium mb-1 block text-end",children:[O(new Date(d.createdAt),{addSuffix:!1})," ","ago"]}):null,d.type==="text"?e.jsx("div",{className:"p-2 bg-lightinfo text-ld dark:bg-lightinfo rounded-md",children:d.msg}):null,d.type==="image"?e.jsx("img",{src:d.msg,height:150,width:150,alt:"user",className:"rounded-md"}):null]})})},d.id+d.createdAt))}),e.jsx("div",{ref:c})]})})})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`shrink-0 ${s?"xl:max-w-[300px] max-w-0":"max-w-[0]"}`,children:e.jsx(_,{})}),e.jsx(X,{open:p,onClose:v,className:"max-w-[300px] ",position:"right",children:e.jsx("div",{children:e.jsx(_,{})})})]})]})]})},He=()=>{var d;const{selectedChat:t}=u.useContext(P),a=F(l=>l.auth.user),[s,n]=u.useState(""),i=Z(),c=((d=t==null?void 0:t.messages[(t==null?void 0:t.messages.length)-1])==null?void 0:d.prompts)??null,[o,m]=u.useState(!0);u.useEffect(()=>{var l;(l=t==null?void 0:t.messages[(t==null?void 0:t.messages.length)-1])!=null&&l.prompts&&m(!0)},[t]);const p=l=>{n(l.target.value)};console.log("initialPrompts ",c,t==null?void 0:t.messages[(t==null?void 0:t.messages.length)-1]);const x=l=>{l.preventDefault(),!(!s.trim()||!t)&&(f(),m(!1),n(""))},v=l=>{console.log("pressed the button ",l),f(l),m(!1),n("")},f=async l=>{const w=l||s;console.log("got here 1 ",a),console.log("selectedChat ",t),i(ee({receiverId:t==null?void 0:t.id,senderId:a._id,content:w,chatRoomId:null,type:"text"}))};return e.jsxs(e.Fragment,{children:[o&&c&&e.jsxs("div",{className:"flex flex-row mb-[50px] relative -top-[50px] justify-center",children:[" ",c.map(l=>l!==""&&e.jsx(J,{onClick:()=>v(l),size:"xs",color:"lightinfo",className:"rounded-lg mx-[5px]",children:l}))]}),e.jsx("form",{onSubmit:x,children:e.jsxs("div",{className:"flex gap-3 items-center py-5 px-5",children:[e.jsx("div",{children:e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(b,{icon:"solar:sticker-smile-circle-2-linear",height:"20"})})}),e.jsx(Y,{className:"form-control-chat border-0 w-full",sizing:"md",required:!0,value:s,onChange:p}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx("div",{className:"btn-circle-hover cursor-pointer ",children:e.jsx(b,{icon:"solar:plain-linear",height:"20",onClick:v})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(b,{icon:"solar:gallery-add-linear",height:"20"})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(b,{icon:"solar:paperclip-outline",height:"20"})}),e.jsx("div",{className:"btn-circle-hover cursor-pointer",children:e.jsx(b,{icon:"solar:microphone-2-outline",height:"20"})})]})]})})]})},Xe=()=>{const[t,a]=u.useState(!1),s=()=>a(!1);return e.jsx(e.Fragment,{children:e.jsx(Le,{children:e.jsx(te,{className:"p-0 overflow-hidden",children:e.jsxs("div",{className:"flex",children:[e.jsx(X,{open:t,onClose:s,className:"lg:relative lg:transform-none lg:h-auto lg:bg-transparent max-w-[350px] w-full  lg:z-[0] ",children:e.jsx(Ye,{})}),e.jsxs("div",{className:"grow w-[70%]",children:[e.jsx(Je,{onClickMobile:()=>a(!0)}),e.jsx(H,{className:"my-0"}),e.jsx(He,{})]})]})})})})},Qe=[{to:"/",title:"Home"},{title:"Chat"}],Ke=()=>e.jsxs(e.Fragment,{children:[e.jsx(se,{title:"Chat App",items:Qe}),e.jsx(Xe,{})]});export{Ke as default};
